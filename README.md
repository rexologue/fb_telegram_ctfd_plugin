# First Blood Telegram (CTFd plugin)

–ü–ª–∞–≥–∏–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ø–µ—Ä–≤–æ–µ –≤–∏–¥–∏–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ** (FIRST BLOOD) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

- **–í–∏–¥–∏–º–æ–µ** = –∞–∫–∫–∞—É–Ω—Ç –Ω–µ `hidden` –∏ –Ω–µ `banned`.
- –ï—Å–ª–∏ ¬´—Å–∞–º–æ–µ –ø–µ—Ä–≤–æ–µ¬ª —Ä–µ—à–µ–Ω–∏–µ –±—ã–ª–æ –æ—Ç —Å–∫—Ä—ã—Ç–æ–≥–æ/–∑–∞–±–∞–Ω–µ–Ω–Ω–æ–≥–æ ‚Äî –ø–ª–∞–≥–∏–Ω –æ–±—ä—è–≤–∏—Ç –ø–µ—Ä–≤–æ–≥–æ *–≤–∏–¥–∏–º–æ–≥–æ* —Å–æ–ª–≤–µ—Ä–∞.

---

## 1) –ö–∞–∫ –ø–æ–¥–Ω—è—Ç—å

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- CTFd (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ –≤–µ—Ç–∫–µ 3.8.x)
- –î–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ, –≥–¥–µ –ª–µ–∂–∏—Ç –≤–∞—à CTFd (–∏–ª–∏ –∫ Docker-—Ç–æ–º–∞–º/—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ñ–∞–π–ª—ã)
1) –°–∫–æ–ø–∏—Ä—É–π –ø–∞–ø–∫—É –ø–ª–∞–≥–∏–Ω–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–ª–∞–≥–∏–Ω–æ–≤ CTFd:

- –∏—Ç–æ–≥–æ–≤—ã–π –ø—É—Ç—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–∏–º:
  - `CTFd/plugins/first_blood_telegram/__init__.py`

2) –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ CTFd (–ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º, –∫–æ—Ç–æ—Ä—ã–π —É —Ç–µ–±—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).

–ü—Ä–∏–º–µ—Ä—ã (–µ—Å–ª–∏ —É —Ç–µ–±—è Docker Compose ‚Äî –∫–æ–º–∞–Ω–¥—ã –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –ø–æ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞):
- `docker compose restart ctfd`
- `docker compose up -d --build`

### –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–ª–∞–≥–∏–Ω —Ä–µ–∞–ª—å–Ω–æ –ø–æ–¥–Ω—è–ª—Å—è
1) –ó–∞–π–¥–∏ –≤ CTFd –ø–æ–¥ –∞–¥–º–∏–Ω–æ–º.
2) –û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–ª–∞–≥–∏–Ω–∞ (—ç—Ç–æ –∏ –µ—Å—Ç—å UI):
- `https://<CTFD_HOST>/admin/first_blood_telegram/`

–ï—Å–ª–∏ –≤–∏–¥–∏—à—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ –∫–Ω–æ–ø–∫–∞–º–∏ **Save / Send test** ‚Äî –ø–ª–∞–≥–∏–Ω –ø–æ–¥–Ω—è—Ç.

### –ï—Å–ª–∏ –Ω–µ –ø–æ–¥–Ω—è–ª–æ—Å—å (–±—ã—Å—Ç—Ä—ã–π —á–µ–∫-–ª–∏—Å—Ç)
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–∞–ø–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Ä–æ–≤–Ω–æ** `first_blood_telegram` –∏ –ª–µ–∂–∏—Ç **–≤–Ω—É—Ç—Ä–∏** `CTFd/plugins/`.
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä CTFd —Ä–µ–∞–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç/–ø—Ä–æ–∫—Å–∏).
- –ï—Å–ª–∏ —É —Ç–µ–±—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: —É–±–µ–¥–∏—Å—å, —á—Ç–æ –ø–∞–ø–∫–∞ –ø–ª–∞–≥–∏–Ω–∞ –ø–æ–ø–∞–ª–∞ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (volume / bind mount / –æ–±—Ä–∞–∑ –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω).

---

## 2) –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ UI

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–µ–ª–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–ª–∞–≥–∏–Ω–∞**:
- `https://<CTFD_HOST>/admin/first_blood_telegram/`

### –®–∞–≥ A. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å Telegram (–±–æ—Ç + –∫—É–¥–∞ —Å–ª–∞—Ç—å)
–¢–µ–±–µ –Ω—É–∂–Ω–æ:
- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- `CHAT_ID` (–∏–ª–∏ `@channelusername`) ‚Äî –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è

#### A1) –ü–æ–ª—É—á–∏—Ç—å BOT_TOKEN
1) –í Telegram –æ—Ç–∫—Ä–æ–π `@BotFather`
2) –°–æ–∑–¥–∞–π –±–æ—Ç–∞: `/newbot`
3) –°–∫–æ–ø–∏—Ä—É–π —Ç–æ–∫–µ–Ω –≤–∏–¥–∞: `123456789:AA...`

#### A2) –í—ã–±—Ä–∞—Ç—å –∫—É–¥–∞ —Å–ª–∞—Ç—å (–≥—Ä—É–ø–ø–∞ / –∫–∞–Ω–∞–ª / –ª–∏—á–∫–∞)
- **–õ–∏—á–∫–∞:** –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (Start).
- **–ì—Ä—É–ø–ø–∞:** –¥–æ–±–∞–≤—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É, –¥–∞–π –ø—Ä–∞–≤–æ –ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—ã—á–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º; –∏–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞).
- **–ö–∞–Ω–∞–ª:** –¥–æ–±–∞–≤—å –±–æ—Ç–∞ –∞–¥–º–∏–Ω–æ–º –∫–∞–Ω–∞–ª–∞ (–∏–Ω–∞—á–µ –æ–Ω –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ—Å—Ç–∏—Ç—å).

#### A3) –£–∑–Ω–∞—Ç—å CHAT_ID (—Å–∞–º—ã–π –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–±)
**–í–∞—Ä–∏–∞–Ω—Ç 1 (–±—ã—Å—Ç—Ä–æ, —á–µ—Ä–µ–∑ ‚Äú—Å—ã—Ä–æ–≥–æ‚Äù –±–æ—Ç–∞):**
1) –î–æ–±–∞–≤—å –≤ –Ω—É–∂–Ω—ã–π —á–∞—Ç/–≥—Ä—É–ø–ø—É –±–æ—Ç–∞ `@RawDataBot` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/ID)
2) –ù–∞–ø–∏—à–∏ –≤ —á–∞—Ç –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3) –û–Ω –ø–æ–∫–∞–∂–µ—Ç –æ–±—ä–µ–∫—Ç, –≥–¥–µ –±—É–¥–µ—Ç `chat` ‚Üí `id` ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å `CHAT_ID`

**–í–∞—Ä–∏–∞–Ω—Ç 2 (—á–µ—Ä–µ–∑ Telegram API getUpdates):**
1) –ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–≤–æ–µ–º—É –±–æ—Ç—É (–≤ –ª–∏—á–∫—É –∏–ª–∏ –≤ –≥—Ä—É–ø–ø—É)
2) –û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
   - `https://api.telegram.org/bot<BOT_TOKEN>/getUpdates`
3) –í –æ—Ç–≤–µ—Ç–µ –Ω–∞–π–¥–∏ `message` ‚Üí `chat` ‚Üí `id`

> –î–ª—è –≥—Ä—É–ø–ø/–∫–∞–Ω–∞–ª–æ–≤ `CHAT_ID` —á–∞—Å—Ç–æ **–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä `-1001234567890`).

**–í–∞–∂–Ω–æ –ø—Ä–æ privacy mode (–µ—Å–ª–∏ getUpdates ‚Äú–ø—É—Å—Ç–æ–π‚Äù –≤ –≥—Ä—É–ø–ø–∞—Ö):**
- –£ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–æ—Ç–æ–≤ privacy mode –º–µ—à–∞–µ—Ç –≤–∏–¥–µ—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ.
- –í `@BotFather` –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å privacy: `/setprivacy` ‚Üí –≤—ã–±—Ä–∞—Ç—å –±–æ—Ç–∞ ‚Üí `Disable`.
- –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π –≤–∞—Ä–∏–∞–Ω—Ç —Å `@RawDataBot`.

---

### –®–∞–≥ B. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ UI CTFd
–û—Ç–∫—Ä–æ–π:
- `https://<CTFD_HOST>/admin/first_blood_telegram/`

–ó–∞–ø–æ–ª–Ω–∏:

1) **Enabled**
- –í–∫–ª—é—á–∞–µ—Ç/–≤—ã–∫–ª—é—á–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π.
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: —Å–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Å—ë, —Å–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –≤–∫–ª—é—á–∞—Ç—å –Ω–∞ –±–æ—é.

2) **Bot token**
- –í—Å—Ç–∞–≤—å `BOT_TOKEN`

3) **Chat ID**
- –í—Å—Ç–∞–≤—å `CHAT_ID`
- (–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–∞–Ω–∞–ª, –∏–Ω–æ–≥–¥–∞ –º–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å `@channelusername`, –Ω–æ —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî numeric `CHAT_ID`.)

4) **Parse mode**
- `""` (–ø—É—Å—Ç–æ) ‚Äî –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `HTML` ‚Äî Telegram HTML-—Ä–∞–∑–º–µ—Ç–∫–∞
- `MarkdownV2` ‚Äî –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ: —Ç–∞–º –Ω—É–∂–Ω–æ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã

5) **Template**
–®–∞–±–ª–æ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã:

- `{solver}` ‚Äî –∏–º—è —Å–æ–ª–≤–µ—Ä–∞ (—é–∑–µ—Ä/—Ç–∏–º)
- `{solver_type}` ‚Äî `user` –∏–ª–∏ `team`
- `{challenge}` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è
- `{category}` ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- `{points}` ‚Äî —Å—Ç–æ–∏–º–æ—Å—Ç—å
- `{solve_id}` ‚Äî id solve
- `{challenge_id}` ‚Äî id –∑–∞–¥–∞–Ω–∏—è
- `{date_utc}` ‚Äî –≤—Ä–µ–º—è (UTC) –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏

–ü—Ä–∏–º–µ—Ä (–±–µ–∑ parse_mode):
- `ü©∏ FIRST BLOOD! {solver} solved {challenge} (+{points})`

–ü—Ä–∏–º–µ—Ä (HTML):
- `ü©∏ <b>FIRST BLOOD!</b> <code>{solver}</code> solved <b>{challenge}</b> (+{points})`

–ù–∞–∂–º–∏ **Save**.

---

### –®–∞–≥ C. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ UI (test message)
–ù–∞ —Ç–æ–π –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –Ω–∞–∂–º–∏ **Send test**.

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- –í Telegram-—á–∞—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –ï—Å–ª–∏ –Ω–µ –ø—Ä–∏—à–ª–æ ‚Äî —Å–º. ¬´–¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã¬ª –Ω–∏–∂–µ.

---

### –®–∞–≥ D. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–æ—é (—Ä–µ–∞–ª—å–Ω—ã–π FIRST BLOOD)
1) –°–æ–∑–¥–∞–π —Ç–µ—Å—Ç–æ–≤—ã–π –∞–∫–∫–∞—É–Ω—Ç/–∫–æ–º–∞–Ω–¥—É (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –Ω–µ-–∞–¥–º–∏–Ω –∞–∫–∫–∞—É–Ω—Ç).
2) –†–µ—à–∏ –ª—é–±—É—é –∑–∞–¥–∞—á—É –≤–ø–µ—Ä–≤—ã–µ (–∏–ª–∏ —Å–æ–∑–¥–∞–π –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –¥–ª—è —Ç–µ—Å—Ç–∞).
3) –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–ª–µ—Ç–µ–ª–æ –≤ Telegram.

---

### –¢–∏–ø–æ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–∏ —á—Ç–æ –¥–µ–ª–∞—Ç—å)
**1) –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç**
- –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ `Enabled = true`
- –ü—Ä–æ–≤–µ—Ä—å `BOT_TOKEN` (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤)
- –ü—Ä–æ–≤–µ—Ä—å `CHAT_ID` (–æ—Å–æ–±–µ–Ω–Ω–æ –∑–Ω–∞–∫ `-` –∏ –ø—Ä–µ—Ñ–∏–∫—Å `-100...`)
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ –ø–∏—Å–∞—Ç—å:
  - –≤ –≥—Ä—É–ø–ø–µ: –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∏ –Ω–µ –∑–∞–º—å—é—á–µ–Ω
  - –≤ –∫–∞–Ω–∞–ª–µ: –±–æ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω–æ–º

**2) –í –∫–∞–Ω–∞–ª–µ –Ω–µ –ø–æ—Å—Ç–∏—Ç**
- –ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—á–∏–Ω–∞: –±–æ—Ç –Ω–µ –∞–¥–º–∏–Ω –∫–∞–Ω–∞–ª–∞ –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤–∞ ‚ÄúPost messages‚Äù.

**3) MarkdownV2 ‚Äú–ª–æ–º–∞–µ—Ç‚Äù —Å–æ–æ–±—â–µ–Ω–∏–µ**
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –≤ –ø–æ–ª—è—Ö –µ—Å—Ç—å `_ * [ ] ( ) ~ ` > # + - = | { } . !`
- –õ–∏–±–æ —ç–∫—Ä–∞–Ω–∏—Ä—É–π, –ª–∏–±–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ `HTML`/–ø—É—Å—Ç–æ–π —Ä–µ–∂–∏–º.

**4) FIRST BLOOD –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, —Ö–æ—Ç—è —Å–æ–ª–≤ –µ—Å—Ç—å**
- –ü–ª–∞–≥–∏–Ω –æ–±—ä—è–≤–ª—è–µ—Ç **–ø–µ—Ä–≤–æ–µ –≤–∏–¥–∏–º–æ–µ** —Ä–µ—à–µ–Ω–∏–µ.
- –ï—Å–ª–∏ –ø–µ—Ä–≤—ã–º —Ä–µ—à–∏–ª hidden/banned ‚Äî –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —É–π–¥—ë—Ç –Ω–∞ –ø–µ—Ä–≤–æ–≥–æ –≤–∏–¥–∏–º–æ–≥–æ (–º–æ–∂–µ—Ç –∫–∞–∑–∞—Ç—å—Å—è ‚Äú–Ω–µ –ø–µ—Ä–≤—ã–º‚Äù).
